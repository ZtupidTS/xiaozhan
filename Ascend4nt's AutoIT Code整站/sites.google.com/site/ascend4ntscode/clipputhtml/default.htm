<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><!-- saved from url=(0067)http://sites.google.com/site/ascend4ntscode/clipputhtml/default.htm -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { // Input 0
var a=window;
// Input 1
var b="start";function d(f){this.t={};this.tick=function(g,h,c){c=c?c:(new Date).getTime();this.t[g]=[c,h]};this.tick(b,null,f)}var e=new d;a.jstiming={Timer:d,load:e};try{var i=null;if(a.chrome&&a.chrome.csi)i=Math.floor(a.chrome.csi().pageT);if(i==null)if(a.gtbExternal)i=a.gtbExternal.pageT();if(i==null)if(a.external)i=a.external.pageT;if(i)a.jstiming.pt=i}catch(j){};
// Input 2
})()
</script>
<link rel="shortcut icon" href="../../../../www.gstatic.com/sites/p/8c5068/system/app/images/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="../../../../www.gstatic.com/sites/p/8c5068/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e=parseInt,h=window,i="length";function j(a){return document.getElementById(a)}h.byId=j;var k="";function l(a){return a.replace(/^\s+|\s+$/g,k)}h.trim=l;
var m="MSIE",n="6.0",o="string",p='id="',q='" ',r='class="',s='title="',t="display:inline-block;",u="left",v="float:left;",w="right",x="float:right;",y="cursor:hand;",z="<span ",A=' style="width:',B="px; height:",C="px;",D=";padding: 0;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='",E="', sizingMethod='scale');\"></span><span style=\"padding: ",F=" ",G=";",H="float:",I='"></span>';
h.ie6ImgFix=function(a){var b=h.navigator?navigator.userAgent:k;if(b.indexOf(m)!=-1&&typeof opera=="undefined"){var d=/MSIE\s+([^\);]+)(\)|;)/;d.test(b);b=RegExp.$1;if(b==n){var c=typeof a==o?j(a):a;a=c.id?p+c.id+q:k;b=c.className?r+c.className+q:k;d=c.title?s+c.title+q:s+c.alt+q;var f=t+c.style.cssText;if(c.align==u)f=v+f;if(c.align==w)f=x+f;if(c.parentElement.href)f=y+f;var g=c.currentStyle,L=c.width-e(g.paddingLeft,10)-e(g.paddingRight,10),M=c.height-e(g.paddingTop,10)-e(g.paddingBottom,10),N=
z+a+b+d+A+L+B+M+C+f+D+c.src+E+g.paddingTop+F+g.paddingRight+F+g.paddingBottom+F+g.paddingLeft+G+(g.styleFloat?H+g.styleFloat+G:k)+I;h.setTimeout(function(){c.outerHTML=N},1)}}};var J=[],K=0;h.JOT_addListener=function(a,b,d){var c=new String(K++);a={eventName:a,handler:b,compId:d,key:c};J.push(a);return c};h.JOT_removeListenerByKey=function(a){for(var b=0;b<J[i];b++)if(J[b].key==a){J.splice(b,1);break}};
h.JOT_removeAllListenersForName=function(a){for(var b=0;b<J[i];b++)J[b].eventName==a&&J.splice(b,1)};var O="function";h.JOT_postEvent=function(a,b,d){var c={eventName:a,eventSrc:b||{},payload:d||{}};if(h.JOT_fullyLoaded){b=J[i];for(d=0;d<b&&d<J[i];d++){var f=J[d];if(f&&f.eventName==a){c.listenerCompId=f.compId||k;(f=typeof f.handler==O?f.handler:h[f.handler])&&f(c)}}}else h.JOT_delayedEvents.push({eventName:a,eventSrc:b,payload:d})};h.JOT_delayedEvents=[];h.JOT_fullyLoaded=false;var P="__duration__";
h.JOT_formatRelativeToNow=function(a,b){a=((new Date).getTime()-a)/6E4;if(a>=1440||a<0)return null;var d=0;if(a>=60){a/=60;d=2}a>=2&&d++;return b?h.JOT_siteRelTimeStrs[d].replace(P,Math.floor(a)):h.JOT_userRelTimeStrs[d].replace(P,Math.floor(a))}; })()
</script>
<script>


var webspace = {"signInUrl":"../../../../https@www.google.com\a\universallogin@continue=http_253a_252f_252fsites.google.com_252fsite_252fascend4ntscode_252fclipputhtml&service=jotspot","isGaiaBarRendered":true,"isConsumer":true,"termsUrl":"../../../../www.google.com/sites/help/intl/en/terms.html","enableAnalytics":true,"homePath":"/","sharingPolicy":"OPENED","isAdsenseEnabled":true,"analyticsAccountId":"UA-10188299-2","baseUri":"../default.htm","name":"ascend4ntscode","features":{"lazySiteHierarchy":true,"subpageNav":false,"multipleCalendar":true,"enableNewBrowserEditChecks":true,"useStandardEmbedsInSidebar":false,"experimental":{"displayEditorLockExceptions":false},"navadminperf":false,"structuredDataSchemas":false,"kixEmbedSupport":true},"domain":"defaultdomain","adsensePublisherId":null,"isStartPageEnabled":false,"domainAnalyticsAccountId":"","siteTitle":"Ascend4nt's AutoIT Code"};


webspace.gadgets = {"isGadgetDirectoryEnabled":true,"baseUri":"../system/app/pages/gadgets.htm","isGgsRenderingEnabled":true};


webspace.user = {"uid":"","hasAdminAccess":false,"guest_":true,"domain":"","hasWriteAccess":false,"userName":"guest","dasherUser":false,"primaryEmail":"guest","displayNameOrEmail":"guest"};

webspace.page = {"canDeleteWebspace":null,"locale":"en","state":"","wuid":"wuid:gx:6b71d77e5da91118","timeZone":"Asia/Hong_Kong","properties":{},"type":"text","canChangePath":true,"parentWuid":null,"revision":8,"title":"_ClipPutHTML","isRtlLocale":false,"bidiEnabled":false,"siteLocale":"en","name":"clipputhtml","path":"../../../clipputhtml","isSiteRtlLocale":false,"parentPath":null};


var editorResources = [
  '../../../../www.gstatic.com/sites/p/8c5068/system/js/trog_edit__en.js',
  '../../../../www.gstatic.com/sites/p/8c5068/system/app/css/trogedit.css',
  '../_/rsrc/1270057038245/system/app/css/editor.css'
];

var JOT_clearDotPath = '../../../../www.gstatic.com/sites/p/8c5068/system/app/images/cleardot.gif';


var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];


webspace.page.currentTemplate = {"title":"Web Page","path":"../../../system/app/pagetemplates/text"};





var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="Description" content="My AutoIT code source" />
<style type="text/css">#body .goog-menuitem .sites-moreactions-icon {
margin-top: 0;
}

/* Not sure exactly why, but I found that in the presence of position: relative
(css) we need to trigger IE's internal, proprietary "hasLayout" mode in order
to render correctly.  This is for all the zoom: 1 (css) in the file. */
#body #sites-page-toolbar {
zoom: 1;
position: relative;
}

/* (midoringo) fixes b1471374 rule for toolbar to show correctly in RTL for IE6 */
/* Don't know what exactly this fix the problem. */
#sites-page-toolbar #sites-page-info-bar {
/* position: static; */
zoom: 1;
}

/* rule for toolbar's border-bottom to show correctly in RTL for IE6 */
#sites-collaborator-bar{
position: relative;
}

#sites-searchbox-search-button{
height: 21px;
}

#sites-searchbox-select-button-wrapper{
height: 21px;
}

#body .sites-attachment-icon,
#body .sites-comment-icon {
font-size: 1px !important;
}

/* trigger layout, otherwise the bgcolor on the comments area only fills to halfway down */
#body #sites-comment-wrapper,
#body #sites-attachment-wrapper {
zoom: 1;
}

#body .sites-button-icon {
margin-right: 5px;
}

/* (midoringo) This fixes bug 1867401, seems like position: static fixes some */
/* IE RTL problem, but I don't know how exactly this fix the problem. */
#body .modal-dialog-title {
/* position: static; */
zoom: 1;
}

#body .modal-dialog-content {
height: 1%;
}

#body .goog-sites-pagefinder hr {
clear: both;
}

#body .goog-sites-pagefinder .goog-tabpane {
height: 225px;
}

#body .modal-dialog .goog-ws-logo {
width: 400px;
}

#body .goog-button-base {
margin-left: 2px;
margin-right: 2px;
}

#body .sites-filecab-icon-delete {
height: 20px;
background-position: 0 2px;
}

#body .sites-filecab-icon-folder {
height: 20px;
background-position: 0 2px;
}

#body .sites-filecab-icon-new {
height: 20px;
background-position: 0 2px;
}

#body .sites-toolbar-icon-new {
height: 20px;
background-position: 0 2px;
}

#body .sites-toolbar-icon-edit {
height: 20px;
background-position: -13px 2px;
}

#body .sites-toolbar-icon-more-actions {
height: 20px;
margin: 0;
}

#body .sites-format-menu {
/* IE 6 hack - otherwise it renders the menu at 100% screen width for some
reason */
_width: 20em;
}

.sites-format-menu .goog-menuitem-rtl {
width: 150px;
}

.sites-menu-insert .goog-menuitem-rtl{
width: 200px;
}

.sites-format-submenu .goog-menuitem-rtl {
width: 60px;
}

.sites-insert-submenu .goog-menuitem-rtl{
width: 100px;
}

.sites-menu-layout .goog-menuitem-rtl{
width: 15em;
}

/* This is fix for bug 1891361 in the IE6 portion, This allows the icon in the
MenuItem to display correctly on the right side. */
#body .goog-toolbar-menu-item-icon {
_position: static;
}

#body .announcements .announcement .postfooter p {
margin: 0;
padding: 0 0 15px;
}

#body .filecabinet .filecabinet-table {
border-collapse: collapse;
}

#body .announcements {
zoom: 1;
}

/* Fix for bug 1902901, parts of the list page are rendered off screen for
IE RTL.  This fixes the position: relative used by the layout */
#body .sites-list-showing-items,
#body #sites-list-controls,
#body .list-page {
zoom: 1;
}

/* Fix for bug 1902397, float right causes text to shift out of bound of the
containing <a> */
#body .sites-list-sort-button {
float: none;
}

#addPageElementEl .goog-ws-add {
margin-right: 12px;
}

#body .lp-createpage-tree {
height: 202px;
}

.sitelayout-dlg-img-container {
zoom: 1;
}

.sites-sidebar-nav li {
zoom: 1;
}

.nav-toc-content li {
zoom: 1;
}

td.sites-copy-cell-name {
padding: 6px 10px 0 10px;
}

td.sites-copy-cell {
padding-top: 6px;
}

/*hack to fix the collaborator bar gradient for ie */
#sites-page-toolbar {
position: relative;
z-index: 101;
}


/* Both IE6 and IE7 look at the css rule border-bottom-width: 0 and use
* width: 1px instead... fortunately IE7 knows what border-color: transparent
* means, so it doesn't have ugly border allover.  This rule targets nav in IE6
* and set border-width to 0px to get rid of the problem.
*/
#body .sites-sidebar-nav li,
#body .sites-sidebar-nav div,
#body .sites-sidebar-nav a {
_border-bottom-width: 0px !important;
}

.sites-clear {
zoom: 1;        /* triggers hasLayout */
display: block; /* resets display for IE/Win */
}
</style>
<link rel="stylesheet" type="text/css" href="../../../../www.gstatic.com/sites/p/8c5068/system/app/themes/slate/standard-css-slate-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1270057038601/system/app/css/overlay.css@cb=slate170goog-ws-left.css" />
<title>_ClipPutHTML (Ascend4nt's AutoIT Code)</title>
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>

<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en">
<div id="sites-page-toolbar">
<div id="sites-status" class="sites-status" style="display:none;">
<div id="sites-notice" class="sites-notice"> </div>
</div>
</div>
<div id="sites-chrome-everything" style="direction: ltr">
<div id="sites-chrome-page-wrapper">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0">
<tr class="sites-header-primary-row">
<td id="sites-header-title">
<h2><a href="../default.htm" dir="ltr">Ascend4nt's AutoIT Code</a></h2>
</td>
<td class="sites-layout-searchbox">
<div>
<form id="sites-searchbox-form" action="/site/ascend4ntscode/system/app/pages/search">
<input type="text" onpropertychange="JOT_setTextDir(this)" oninput="JOT_setTextDir(this)" dir="" id="jot-ui-searchInput" name="q" size="20" />
<input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" />
<div class="goog-inline-block goog-button goog-button-base   "><div class="goog-inline-block goog-button-base-outer-box"><div class="goog-inline-block goog-button-base-inner-box"><div class="goog-button-base-pos"><div class="goog-button-base-top-shadow"> </div><div id="sites-searchbox-search-button" class="goog-button-base-content " style="" onclick=""><span id="sites-searchbox-search-button-label">Search this site</span></div></div></div></div></div>
</form>
</div>
</td>
</tr>
</table> 
</div> 
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed">
<div class="sites-embed-content sites-sidebar-nav ">
<ul jotId="navList">
<li class="topLevel nav-first"><div dir="ltr" style="padding-left: 19px;"><a href="../home/default.htm" jotId="wuid:gx:3e0bfbf64d02f7bd" class="topLevel">Ascend4nt's AutoIT Code</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../arraysortindirect.htm" jotId="wuid:gx:33225ec9cbebefd0" class="topLevel">_ArraySortIndirect</a>
</div></li>
<li class="topLevel parent" wuid="gx:7367f77e4722ca7c"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../clipgethtml/default.htm" jotId="wuid:gx:7367f77e4722ca7c" class="topLevel">_ClipGetHTML</a>
</div><ul>
<li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../clipgethtml/htmlclipboardmonitor.htm" jotId="wuid:gx:31ba070512d79f64">HTMLClipboardMonitor</a>
</div></li>
</ul>
</li>
<li class="topLevel parent" wuid="gx:6b71d77e5da91118"><div class="current-bg" jotId="wuid:gx:6b71d77e5da91118" dir="ltr" style="padding-left: 0px;"><div class="expander"></div>_ClipPutHTML
</div><ul>
<li class=""><div dir="ltr" style="padding-left: 38px;"><a href="hyperlinkputexample.htm" jotId="wuid:gx:1b03857ed9607985">HyperLinkPutExample</a>
</div></li>
<li class=""><div dir="ltr" style="padding-left: 38px;"><a href="puthtmlexample.htm" jotId="wuid:gx:2a5ec4491a7f4d49">PutHTMLExample</a>
</div></li>
</ul>
</li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../clipputhyperlink.htm" jotId="wuid:gx:18588c2947597699" class="topLevel">_ClipPutHyperlink</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../home/crosshairs.htm" jotId="wuid:gx:17790663940aaf0f" class="topLevel">CrossHairs (Full-Screen)</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../dllstructdisplay.htm" jotId="wuid:gx:6f676835b2fa48d8" class="topLevel">_DLLStructDisplay</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../doswildcardstopcregex.htm" jotId="wuid:gx:770f1b424276600e" class="topLevel">_DOSWildcardsToPCRegEx</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../enumchildwindows.htm" jotId="wuid:gx:1a0c75e23eda41b7" class="topLevel">_EnumChildWindows</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../guibox.htm" jotId="wuid:gx:62a67732b3c60a79" class="topLevel">_GUIBox</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../winapifilefind.htm" jotId="wuid:gx:792ed10785ac95ef" class="topLevel">_WinAPI_FileFind</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../winapi_getsysteminfo.htm" jotId="wuid:gx:593d5f86aa661489" class="topLevel">_WinAPI_GetSystemInfo</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../winapi_processgetcreatetime.htm" jotId="wuid:gx:7d305b7e7335ec2a" class="topLevel">_WinAPI_ProcessGetCreateTime</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../winapi_processgetfilename.htm" jotId="wuid:gx:5cb01b89736c55ff" class="topLevel">_WinAPI_ProcessGetFileName</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../winapi_processgetpathname.htm" jotId="wuid:gx:87dbf73f0c12f0c" class="topLevel">_WinAPI_ProcessGetPathname</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../wingetalttabwinlist.htm" jotId="wuid:gx:54b9169eaaceb1e6" class="topLevel">_WinGetAltTabWinList</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../fullscreencrashrecovery.htm" jotId="wuid:gx:782a3c1a874782e3" class="topLevel">FullScreenCrashRecovery</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../contactme.htm" jotId="wuid:gx:35605b72df1045cc" class="topLevel">ContactMe</a>
</div></li>
<li class="topLevel"><div dir="ltr" style="padding-left: 19px;"><a href="../system/app/pages/sitemap/hierarchy.htm" jotId="wuid:gx:888a0a53ca0e3a5" class="topLevel">Sitemap</a>
</div></li>
</ul>

</div>
</div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
</div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr">_ClipPutHTML</span>
</h3>

<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr">Okay, since I created the <a href="../clipputhyperlink.htm">_ClipPutHyperlink() function</a>, I figured I might as well 
just go one step further and open up the whole HTML Clipboard send/put interface 
and make it really simple to use - not only for simple Hyperlinks, but also for 
complete pieces of HTML code as well.<br /><br />Note that 'PlainText' is the 
optional view of your HTML code that should be free of formatting. This is 
helpful when pasting to applications that don't accept HTML formatted strings, 
such as Notepad.<br /><br />Note also that the HTML code NEEDS to be encoded in 
UTF-8 format. (For straight-ANSI/ASCII code, you don't need to do anything, 
UTF-8 encoding only comes into play for Unicode formatting).<br /><br />Anyway, here 
it is. Sample code is on a separate page (see navigation pane to the left)<br />EDIT: Also see sample code for <a href="../clipgethtml/default.htm">_ClipGetHTML()</a>.<br /><br /><br />
<b style="color:rgb(180, 95, 6)"><font size="3">Ascend4nt's AutoIT Code License agreement:</font></b><br />
<b><i>
</i></b><i>While I provide this source code freely, if you do use the code in your projects, all I ask is that:</i><br />
<ol><li>
 If you provide source, keep the header as I have put it, OR, if you
expand it, then at least acknowledge me as the original author, and any other authors I credit<br />
</li><li>
 If the program is released, acknowledge me in your credits (it
doesn't have to state which functions came from me, though  again if
the source is provided - see #1)</li><li>The source <u>on it's own</u> (as opposed to part of a <i>project</i>) can <i>not</i> be posted unless a link to the page(s) where the code were retrieved from is provided and a message stating that the latest updates will be available on the page(s) linked to.</li><li>Pieces of the code can however be discussed on the threads where 
Ascend4nt has posted the code without worrying about further linking.</li></ol><br /><font size="5" style="color:rgb(56, 118, 29)">- _ClipPutHTML.au3 CODE STARTS HERE -</font><br /><br />#include-once<br />#Include &lt;Clipboard.au3&gt;<br />; ===============================================================================================<br />; &lt;_ClipPutHTML.au3&gt;<br />;<br />; Function to put HTML formatted text, or simple Hyperlinks into the Clipboard.<br />;<br />; Functions:<br />;   _ClipPutHTML()          ; Simple function to paste HTML code (in UTF-8 format) into the clipboard,<br />;                           ;   along with a Plain-Text version<br />;   _ClipPutHyperlink()     ; Sends an HTML-style Hyperlink to the ClipBoard<br />;   _ClipBoard_FormatHTML() ; Helper function used to apply a CF_HTML header to a piece of HTML code<br />;                           ;   *REQUIRED part of calling _ClipBoard_SendHTML<br />;   _ClipBoard_SendHTML()   ; Basically a modified version of _ClipBoard_SetData() for sending HTML + PlainText<br />;                           ;   variants to the Clipboard<br />;<br />; Requirements: AutoIT 3.3+ (or Unicode variant of 3.2.12.1)<br />;<br />; Dependencies: &lt;Clipboard.au3&gt;<br />;<br />; Resources:<br />;   CF_HTML (# 49342) Format @ MSDN: http://msdn.microsoft.com/en-us/library/ms649015(VS.85).aspx<br />;   Clipboard Formats @ MSDN: http://msdn.microsoft.com/en-us/library/ms649013(VS.85).aspx<br />;<br />; Author: Ascend4nt<br />; ===============================================================================================<br /><br />; ===============================================================================================<br />; Func _ClipPutHTML($sHTML,$sPlainText)<br />;<br />; Simple method of placing HTML data, and PlainText equivalent (if available), on the clipboard.<br />;<br />; $sHTML = HTML code in UTF-8 format.<br />;   NOTE: this will paste the *entire* piece of HTML code in the Clipboard.<br />;       For finer control, see _ClipBoard_FormatHTML() and _ClipBoard_SendHTML()<br />;       (_ClipPutHyperlink() also uses this customized method of pasting HTML data)<br />; $sPlainText = (optional, but recommended) The text as it would appear in a non-rich-text based edit control<br />;   (for example, Notepad). If left blank, pasting will not work in those controls.<br />;<br />; Returns:<br />;   Success: a handle to the HTML Global memory object, with @extended = handle to PlainText memory object<br />;       NOTE: if @error = -8, the function *partially* succeeded,<br />;           and the HTML Global memory object is returned. (The setting of the PlainText variant failed)<br />;   Failure: 0 returned with @error set:<br />;       @error = 1 = invalid parameter(s)<br />;       @error = -1 = error allocating global memory object, @extended = 1 if occurred on PlainText object<br />;       @error = -2 = error locking global memory object, @extended = 1 if occurred on PlainText object<br />;       @error = -5 = error opening clipboard<br />;       @error = -6 = error emptying clipboard <br />;       @error = -7 = error setting clipboard with HTML data<br />;       @error = -8 = error setting clipboard with PlainText data<br />;       @error = -9 = error registering HTML Data Clipboard format (no attempt to set Clipboard data is made);<br />;<br />; Author: Ascen4nt<br />; ===============================================================================================<br /><br />Func _ClipPutHTML($sHTMLStr,$sPlainText="")<br />    Local $sCF_HTMLStr=_ClipBoard_FormatHTML($sHTMLStr)<br />    If @error Then Return SetError(@error,0,0)<br />    Local $vRet=_ClipBoard_SendHTML($sCF_HTMLStr,$sPlainText)<br />    SetError(@error,@extended)<br />    Return $vRet<br />EndFunc<br /><br />; ===============================================================================================<br />; Func _ClipPutHyperlink($sURL,$sLabel="",$sSourceURL="")<br />;<br />; Puts a simple Hyperlink into the clipboard, in HTML format.<br />;<br />; $sURL = the URL web address (ANSI)<br />; $sLabel = the Label to put on the Hyperlink. If left as "", it will use the $sURL string<br />; $sSourceURL = the URL web address that contained the link (useful in downloads?)<br />;<br />; Returns:<br />;   Success: a handle to the HTML Global memory object, with @extended = handle to PlainText memory object<br />;       NOTE: if @error = -8, the function *partially* succeeded,<br />;           and the HTML Global memory object is returned. (The setting of the PlainText variant failed)<br />;   Failure: 0 returned with @error set:<br />;       @error = 1 = invalid parameter(s)<br />;       @error = -1 = error allocating global memory object, @extended = 1 if occurred on PlainText object<br />;       @error = -2 = error locking global memory object, @extended = 1 if occurred on PlainText object<br />;       @error = -5 = error opening clipboard<br />;       @error = -6 = error emptying clipboard <br />;       @error = -7 = error setting clipboard with HTML data<br />;       @error = -8 = error setting clipboard with PlainText data<br />;       @error = -9 = error registering HTML Data Clipboard format (no attempt to set Clipboard data is made);<br />;<br />; Author: Ascend4nt<br />; ===============================================================================================<br /><br />Func _ClipPutHyperlink($sURL,$sLabel="",$sSourceURL="")<br />    <br />    ; Test parameters. (Label can be converted to a string if something else)<br />    If Not IsString($sURL) Or Not IsString($sSourceURL) Then Return SetError(1,0,0)<br />    <br />    ; Convert Label to a string if it wasn't already (allows passing #'s etc)<br />    If Not IsString($sLabel) Then $sLabel=String($sLabel)<br />    <br />    ; If no Label is specified, use the URL name as the label<br />    If $sLabel="" Then $sLabel=$sURL<br />    <br />    ; 'Sneaky' method of converting regular little-endian 16-bit Unicode to UTF-8 Unicode<br />    ;   (first convert it to UTF-8 *BINARY*, then convert it to a string (pretending its regular ANSI data))<br />    Local $sUTF8Label=BinaryToString(StringToBinary($sLabel,4),1)<br />    <br />    Local $sHTMLStr="&lt;html&gt;&lt;body&gt;" &amp; @CRLF &amp; _<br />        '&lt;a href="' &amp; $sURL &amp; '"&gt;' &amp; $sUTF8Label &amp; '&lt;/a&gt;' &amp; @CRLF &amp; _<br />        "&lt;/body&gt;" &amp; @CRLF &amp; "&lt;/html&gt;"<br /><br />    $sHTMLClipStr=_ClipBoard_FormatHTML($sHTMLStr,15,15+StringLen($sURL)+15+StringLen($sUTF8Label)-1,1,-1,$sSourceURL)<br /><br />    Local $vRet=_ClipBoard_SendHTML($sHTMLClipStr,$sLabel)<br />    SetError(@error,@extended)<br />    Return $vRet<br />EndFunc<br /><br /><br />; ===============================================================================================<br />; Func _ClipBoard_FormatHTML($sHTMLStr,$iFragmentStart=1,$iFragmentEnd=-1,$iHTMLStart=1,$iHTMLEnd=-1,$sSourceURL="")<br />;<br />; Function to apply a CF_HTML header to an HTML string &amp; return the combined string result<br />;   For use in calling _ClipBoard_SendHTML()<br />;<br />; $sHTMLStr = HTML string. (UTF-8 encoding please)<br />; $iFragmentStart = (optional, defaults to 1): Location in HTML string where the actual data to copy STARTS<br />; $iFragmentEnd = (optional, defaults to -1): Location in HTML string where the actual data to copy ENDS<br />;       (if you only know the length, use the formula $iFragmentStart+$iFragmentLen-1 )<br />;       -1 means end of HTML string<br />; $iHTMLStart = (optional, defaults to 1): Location where the HTML code starts (typically at top, or at "&lt;html&gt;")<br />; $iHTMLEnd = (optional, defaults to -1): Location where the HTML code ends (typically at the end, or at right of "&lt;/html&gt;")<br />;       -1 means end of HTML string<br />; $sSourceURL = (optional): If present, will add a "SourceURL:" line to CF_HTML header. Possibly useful for 'referrer' info<br />;<br />; Returns:<br />;   Success: CF_HTML-Formatted string<br />;   Failure: "" with @error set to 1 (invalid parameter(s))<br />;<br />; Author: Ascend4nt<br />; ===============================================================================================<br /><br />Func _ClipBoard_FormatHTML($sHTMLStr,$iFragmentStart=1,$iFragmentEnd=-1,$iHTMLStart=1,$iHTMLEnd=-1,$sSourceURL="")<br /><br />    ; Paramater checks<br />    If Not IsString($sHTMLStr) Then Return SetError(1,0,"")<br />    <br />    Local $iHTMLLen=StringLen($sHTMLStr)<br />    <br />    ; Handle defaults<br />    If $iHTMLEnd=-1 Then $iHTMLEnd=$iHTMLLen<br />    If $iFragmentEnd=-1 Then $iFragmentEnd=$iHTMLLen<br />    <br />    ; Bounds checking<br />    If $iHTMLStart&lt;1 Or $iHTMLStart&gt;$iHTMLEnd Or $iHTMLEnd&gt;$iHTMLLen Then Return SetError(1,0,"")<br />    If $iFragmentStart&lt;$iHTMLStart Or $iFragmentStart&gt;$iFragmentEnd Or $iFragmentEnd&gt;$iHTMLEnd Then Return SetError(1,0,"")<br /><br />    ; Size of standard header = 97 (padded offsets):<br />    ;   Version:0.9 &amp; @CRLF<br />    ;   StartHTML:00000000 &amp; @CRLF<br />    ;   EndHTML:00000000 &amp; @CRLF<br />    ;   StartFragment:00000000 &amp; @CRLF<br />    ;   EndFragment:00000000 &amp; @CRLF<br />    Local $iCF_HTMLLen=97<br />    <br />    ; Source URL passed?<br />    If $sSourceURL&lt;&gt;"" Then<br />        ; Add length of "SourceURL:" + $sSourceURL + 2 (@CRLF) to header size<br />        $iCF_HTMLLen+=12+StringLen($sSourceURL)<br />        $sSourceURL="SourceURL:"&amp;$sSourceURL&amp;@CRLF<br />    EndIf<br />    <br />    ; Return Final String<br />    Return ("Version:0.9" &amp; @CRLF &amp; _<br />        "StartHTML:"&amp; StringRight("0000000"&amp;($iHTMLStart+$iCF_HTMLLen-1),8) &amp; @CRLF &amp; _<br />        "EndHTML:"&amp; StringRight("0000000"&amp;($iHTMLEnd+$iCF_HTMLLen),8) &amp; @CRLF &amp; _       <br />        "StartFragment:"&amp; StringRight("0000000"&amp;($iFragmentStart+$iCF_HTMLLen-1),8) &amp; @CRLF &amp; _<br />        "EndFragment:"&amp; StringRight("0000000"&amp;($iFragmentEnd+$iCF_HTMLLen),8) &amp; @CRLF &amp; _<br />        $sSourceURL &amp; $sHTMLStr)<br />EndFunc<br /><br /><br />; ===============================================================================================<br />; Func _ClipBoard_SendHTML(Const ByRef $sHTMLData,Const ByRef $sPlainText)<br />;<br />; Basically a modified version of _ClipBoard_SetData() for sending HTML + PlainText variants to the Clipboard<br />;   NOTE: CF_HTML format is in UTF-8 encoding. For typical ANSI text, nothing needs to be done,<br />;       but for Unicode characters, do a conversion like such:<br />;           $sUTF8String=BinaryToString(StringToBinary($sUnicodeString,4),1)<br />;   $sPlainText is handled by default as Unicode text<br />;<br />; $sHTMLData = the HTML data string WITH the CF_HTML header applied! (UTF-8 encoding!)<br />;   ** Use _ClipBoard_FormatHTML() to apply the header to the string before calling this!!<br />; $sPlainText = the (Unicode) plain text variant of the HTML data (no rich-text/HTML formatting, just the text)<br />;<br />; Returns:<br />;   Success: a handle to the HTML Global memory object, with @extended = handle to PlainText memory object<br />;       NOTE: if @error = -8, the function *partially* succeeded,<br />;           and the HTML Global memory object is returned. (The setting of the PlainText variant failed)<br />;   Failure: 0 returned with @error set:<br />;       @error = -1 = error allocating global memory object, @extended = 1 if occurred on PlainText object<br />;       @error = -2 = error locking global memory object, @extended = 1 if occurred on PlainText object<br />;       @error = -5 = error opening clipboard<br />;       @error = -6 = error emptying clipboard <br />;       @error = -7 = error setting clipboard with HTML data<br />;       @error = -8 = error setting clipboard with PlainText data<br />;       @error = -9 = error registering HTML Data Clipboard format (no attempt to set Clipboard data is made);<br />;<br />; Author: Original _ClipBoard_SetData() function: Paul Campbell (PaulIA),<br />;   HTML &amp; Unicode modifications by Ascend4nt<br />; ===============================================================================================<br /><br />Func _ClipBoard_SendHTML(Const ByRef $sHTMLData,Const ByRef $sPlainText)<br />    Local $tData, $hLock, $hMemory, $hPTMemory, $iSize, $iCF_HTMLFormat, $iClipErr=0<br /><br />    ; Allocate *Global* system memory for the HTML data &amp; initialize it<br />    $iSize = StringLen($sHTMLData) + 1<br />    $hMemory = _MemGlobalAlloc($iSize, $GHND)<br />    If $hMemory = 0 Then Return SetError(-1, 0, 0)<br />    $hLock = _MemGlobalLock($hMemory)<br />    If $hLock = 0 Then Return SetError(-2, 0, 0)<br />    $tData = DllStructCreate("char[" &amp; $iSize &amp; "]", $hLock)<br />    DllStructSetData($tData,1,$sHTMLData)<br />    _MemGlobalUnlock($hMemory)<br />    <br />    If $sPlainText&lt;&gt;"" Then<br />        ; Allocate *Global* system memory for the PlainText variant of HTML data &amp; initialize it<br />        $iSize = StringLen($sPlainText) + 1<br />        $hPTMemory = _MemGlobalAlloc($iSize*2, $GHND)   ; *2 for Unicode character size<br />        If $hPTMemory = 0 Then Return SetError(-1, 1, 0)<br />        $hLock = _MemGlobalLock($hPTMemory)<br />        If $hLock = 0 Then Return SetError(-2, 1, 0)<br />        $tData = DllStructCreate("wchar[" &amp; $iSize &amp; "]", $hLock)   ; wide (UNICODE) characters<br />        DllStructSetData($tData,1,$sPlainText)<br />        _MemGlobalUnlock($hPTMemory)    <br />    Else<br />        $hPTMemory=0<br />    EndIf<br /><br />    If Not _ClipBoard_Open(0) Then Return SetError(-5, 0, 0)<br />    If Not _ClipBoard_Empty() Then Return SetError(-6, 0, 0)<br />    <br />    ;  CF_HTML in experimentation is generally 49342<br />    $iCF_HTMLFormat=_ClipBoard_RegisterFormat("HTML Format")<br />    <br />    If $iCF_HTMLFormat=0 Then<br />        $iClipErr=-9<br />    ElseIf Not _ClipBoard_SetDataEx($hMemory,$iCF_HTMLFormat) Then<br />        $iClipErr=-7<br />    ElseIf $sPlainText&lt;&gt;"" And Not _ClipBoard_SetDataEx($hPTMemory,13) Then ; $CF_UNICODETEXT = 13  ($CF_TEXT is 1)<br />        $iClipErr=-8<br />    EndIf<br /><br />    _ClipBoard_Close()<br />    <br />    If $iClipErr Then<br />        ; Total failure to place anything on the clipboard?<br />        If $iClipErr&lt;&gt;-8 Then Return SetError($iClipErr,0,0)<br />        ; Since the HTML format was successfuly placed on the clipboard,<br />        ;   we'll set the error, clear @extended, and allow return of the Global HTML memory handle<br />        SetError($iClipErr,0)<br />    Else<br />        ; Put Global PlainText memory handle into @extended<br />        SetError(0,$hPTMemory)<br />    EndIf<br />    ; Return Global HTML memory handle<br />    Return $hMemory<br />EndFunc<br /></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages" class="sites-canvas-bottom-panel-wrapper" style="">
<div class="sites-subpages">
            Subpages <span id="subpages-total-number">(2):</span>
<span>
<a href="hyperlinkputexample.htm" dir="ltr">
                      
                          HyperLinkPutExample
                        
                    </a>
</span>
<span>
<a href="puthtmlexample.htm" dir="ltr">
                      
                          PutHTMLExample
                        
                    </a>
</span>
</div>
</div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-attachments" style="display:none" class="sites-canvas-bottom-no-items">
<div id="sites-attachment-wrapper" class="sites-canvas-bottom-panel-wrapper">
<div jotId="sites-attachment-inner" style="display:none;" class="sites-attachment-inner">
<ul id="JOT_ATTACH_container">
</ul>
</div>
</div>
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments" style="display:none;" class="sites-canvas-bottom-no-items">
<div id="sites-comment-wrapper" class="sites-canvas-bottom-panel-wrapper">
<div jotId="sites-comment-inner" style="display:none;" class="sites-comment-inner">
<div jotId="comments" class="sites-comments">
<div id="_wuid_" jotId="template" class="sites-comment" style="display:none">
<div><strong>_displayNameOrEmail_</strong> - _time_ - <a href="javascript:;" onClick="JOT_postEvent('removeComment', this, {wuid:'_wuid_'});">Remove</a></div>
<p dir="_dir_">_text_</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-subfooter">
<p>
            
                 
                <a href="../../../../https@www.google.com/a/universallogin@continue=http_253a_252f_252fsites.google.com_252fsite_252fascend4ntscode_252fclipputhtml&service=jotspot" class="sites-system-link">Sign in</a>
              
            
                 
                <a href="../system/app/pages/recentchanges.htm" rel="nofollow" class="sites-system-link">Recent Site Activity</a>
              
            
             
            <a href="javascript:void(window.open('../../../../www.google.com/sites/help/intl/en/terms.html'))" class="sites-system-link">Terms</a>
             
            <a href="../system/app/pages/reportabuse@src=_2fclipputhtml" rel="nofollow" target="_blank" class="sites-system-link">Report Abuse</a>
            
                 
                <a href="javascript:;" onclick="window.open(webspace.printUrl)" class="sites-system-link">Print page</a>
              
            
            
             | 
            <b class="powered-by">Powered by <a href="../../../default.htm">Google Sites</a></b>
</p>
</div>
</div>
</div>
</div>
</div> 
</div> 
</div> 

<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>

<script xmlns="http://www.w3.org/1999/xhtml" src="../../../../www.gstatic.com/sites/p/8c5068/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
          var searchBox = new gsites.Searchbox('sites-searchbox-search-button');
          searchBox.initListeners();
          searchBox.setScopesMenu(webspace.page.isSiteRtlLocale);
        </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type;
                      
                      window.jstiming.report(loadTimer);
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();

    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }
 //]]>
</script>
<div id="server-timer-div" style="display:none"> </div>
<script>
          window.jstiming.load.tick('render');
        </script>
</body>
</html>
